#include <xc.h>

// ??????? ??????
#pragma config FOSC = INTRCIO   // ??????? ?? ???????? ?????
#pragma config WDTE = OFF       // ??????? ???? Watchdog Timer
#pragma config PWRTE = ON       // ???? ???? Power-up Timer
#pragma config MCLRE = OFF      // ??????? ???? Master Clear Reset
#pragma config BOREN = ON       // ???? ???? Brown-out Reset
#pragma config CP = OFF         // ??????? ???? Code Protection
#pragma config CPD = OFF        // ??????? ???? Data Code Protection

#define _XTAL_FREQ 4000000  // ?????? ???????? ????? 4MHz

volatile unsigned int timer_count = 0;

void __interrupt() ISR(void) {
    if (TMR1IF) {  // ????? ???? ?????1
        TMR1IF = 0;  // ??? ???? ??? ????
        TMR1 = 65536 - 1000;  // ????? ????? ????? ???? 1 ??????????
        timer_count++;
    }
}

void main(void) {
    // ????? ??????
    TRISIO0 = 1;  // ??? GP0 ?? ????? ????? (????)
    TRISIO2 = 0;  // ??? GP2 ?? ????? ????? (LED)
    GPIO = 0;     // ????? ???? ?????? ?? ???
        CMCON = 7;
    ANSEL = 0 ;

    // ????? ?????1
    T1CON = 0x01;  // ???? ???? ?????1 ?? ????????? 1:1
    TMR1 = 65536 - 1000;  // ????? ????? ????? ???? 1 ??????????
    TMR1IE = 1;  // ???? ???? ???? ?????1
    PEIE = 1;    // ???? ???? ???????? ?????
    GIE = 1;     // ???? ???? ???????? ?????

    while (1) {
        if (GP0 == 1) {  // ????? ???? ???? ????
            GP2 = 1;     // ???? ???? LED
            timer_count = 0;
            while (timer_count < 2000);  // ????? 2 ?????
            GP2 = 0;     // ????? ???? LED
        }
    }
}
